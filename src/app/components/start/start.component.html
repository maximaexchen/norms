<div class="row">
  <div class="col-md-6">
    <h1>
      Willkommen! {{ firstName }}
      {{ lastName }}
    </h1>

    <div *ngIf="userRole === 'owner'; else UserContent">
      Owner Content

      <div *ngFor="let norm of ownerData['norms'] | keyvalue">
        <table
          class="table table-striped"
          *ngIf="(norm.value.users | json) != '{}'"
        >
          <tr>
            <th scope="col" width="10%">User</th>
            <th scope="col" width="10%">NormNumber</th>
            <th scope="col" width="10%">Bestätigt</th>
            <th scope="col" width="10%">Datum</th>
            <th width="10%"></th>
          </tr>

          <tr *ngFor="let user of norm.value.users | keyvalue">
            <td>{{ user.value.name }}</td>
            <td>
              <div *ngFor="let associatedNorm of user.value.associatedNorms">
                {{ associatedNorm.normNumber }} <br />
              </div>
            </td>
            <td>
              <div *ngFor="let associatedNorm of user.value.associatedNorms">
                {{ associatedNorm.confirmed }} <br />
              </div>
            </td>
            <td>
              <div *ngFor="let associatedNorm of user.value.associatedNorms">
                {{ associatedNorm.confirmedDate | date }} <br />
              </div>
            </td>
            <td>
              <div *ngFor="let associatedNorm of user.value.associatedNorms">
                <button
                  (click)="inform(associatedNorm.normId, user.key)"
                  class="btn btn-default"
                  *ngIf="!associatedNorm.confirmed"
                >
                  Benachrichtigen
                </button>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <ng-template #UserContent>
      <h2>Zu bestätigende Normen Updates</h2>

      <table class="table table-striped">
        <tr>
          <th scope="col">
            Nummer
          </th>
          <th scope="col">Revision</th>
          <th scope="col">PDF</th>
          <th scope="col">Received</th>
          <th scope="col">Confirm</th>
        </tr>
        <tr *ngFor="let associatedNorm of associatedNorms">
          <td>
            <a class="js-link" (click)="gotoNorm(associatedNorm.normId)"
              ><i class="fas fa-link"></i> {{ associatedNorm.normNumber }}
            </a>
          </td>
          <td>
            <a class="js-link" (click)="gotoNorm(associatedNorm.normId)"
              ><i class="fas fa-exchange-alt"></i>
              {{ associatedNorm.revisionId }}</a
            >
          </td>
          <td>
            <a
              class="js-link"
              (click)="
                getDownload(associatedNorm.normId, associatedNorm.normDocument)
              "
              ><i class="fas fa-file-download"></i> Download PDF</a
            >
          </td>
          <td>
            <i class="far fa-calendar"></i>
            {{ associatedNorm.date | date: 'dd.MM.yyyy' }}
          </td>
          <td>
            <button
              (click)="confirm(associatedNorm.normId)"
              class="btn btn-default"
              *ngIf="!associatedNorm.confirmed"
            >
              <i class="fas fa-clipboard-check"></i> Bestätigen
            </button>
            <span *ngIf="associatedNorm.confirmed"
              ><i class="far fa-calendar-check"></i>
              {{ associatedNorm.confirmedDate | date: 'dd.MM.yyyy' }}</span
            >
          </td>
        </tr>
      </table>

      <div class="form-check mb-2 mr-sm-2">
        <br />
      </div>
    </ng-template>
  </div>
</div>
